<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LegalDemyst - Upload & Analyze</title>
  <link href="https://fonts.googleapis.com/css?family=Montserrat:600,800|Inter:400,500,600" rel="stylesheet">
  <style>
    :root {
      /* Color System */
      --primary-blue: #2A4D9B;
      --primary-green: #2ECC71;
      --danger-red: #e74c3c;
      --warning-orange: #f39c12;
      --text-primary: #ffffff;
      --text-secondary: rgba(255, 255, 255, 0.8);
      --text-tertiary: rgba(255, 255, 255, 0.6);
      --text-dark: #333333;
      --text-dark-secondary: #666666;
      
      /* Background System */
      --bg-primary: linear-gradient(135deg, #141E30, #243B55);
      --bg-glass: rgba(255, 255, 255, 0.08);
      --bg-glass-hover: rgba(255, 255, 255, 0.12);
      --bg-card: rgba(255, 255, 255, 0.95);
      --bg-card-secondary: linear-gradient(135deg, #f8f9fa, #ffffff);
      
      /* Border System */
      --border-glass: rgba(255, 255, 255, 0.1);
      --border-accent: rgba(46, 204, 113, 0.2);
      --border-radius-sm: 8px;
      --border-radius-md: 12px;
      --border-radius-lg: 20px;
      --border-radius-xl: 25px;
      
      /* Spacing System */
      --space-xs: 8px;
      --space-sm: 12px;
      --space-md: 16px;
      --space-lg: 20px;
      --space-xl: 24px;
      --space-2xl: 32px;
      --space-3xl: 40px;
      --space-4xl: 48px;
      --space-5xl: 64px;
      
      /* Typography System */
      --font-primary: 'Inter', sans-serif;
      --font-heading: 'Montserrat', sans-serif;
      --text-xs: 12px;
      --text-sm: 14px;
      --text-base: 16px;
      --text-lg: 18px;
      --text-xl: 20px;
      --text-2xl: 24px;
      --text-3xl: 32px;
      --text-4xl: 48px;
      
      /* Shadow System */
      --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.1);
      --shadow-md: 0 4px 15px rgba(0, 0, 0, 0.15);
      --shadow-lg: 0 8px 25px rgba(0, 0, 0, 0.2);
      --shadow-xl: 0 15px 40px rgba(0, 0, 0, 0.3);
      --shadow-accent: 0 4px 15px rgba(46, 204, 113, 0.3);
    }

    * { 
      margin: 0; 
      padding: 0; 
      box-sizing: border-box; 
    }

    body {
      font-family: var(--font-primary);
      background: var(--bg-primary);
      background-size: 300% 300%;
      animation: gradientShift 20s ease infinite;
      min-height: 100vh;
      color: var(--text-primary);
      overflow-x: hidden;
      font-size: var(--text-base);
      line-height: 1.6;
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Typography Components */
    .text-xs { font-size: var(--text-xs); }
    .text-sm { font-size: var(--text-sm); }
    .text-base { font-size: var(--text-base); }
    .text-lg { font-size: var(--text-lg); }
    .text-xl { font-size: var(--text-xl); }
    .text-2xl { font-size: var(--text-2xl); }
    .text-3xl { font-size: var(--text-3xl); }

    .font-medium { font-weight: 500; }
    .font-semibold { font-weight: 600; }
    .font-bold { font-weight: 700; }
    .font-extrabold { font-weight: 800; }

    .heading {
      font-family: var(--font-heading);
      font-weight: 800;
      line-height: 1.1;
    }

    /* Spacing Utilities */
    .p-xs { padding: var(--space-xs); }
    .p-sm { padding: var(--space-sm); }
    .p-md { padding: var(--space-md); }
    .p-lg { padding: var(--space-lg); }
    .p-xl { padding: var(--space-xl); }
    .p-2xl { padding: var(--space-2xl); }
    .p-3xl { padding: var(--space-3xl); }

    .m-xs { margin: var(--space-xs); }
    .m-sm { margin: var(--space-sm); }
    .m-md { margin: var(--space-md); }
    .m-lg { margin: var(--space-lg); }
    .m-xl { margin: var(--space-xl); }

    .gap-sm { gap: var(--space-sm); }
    .gap-md { gap: var(--space-md); }
    .gap-lg { gap: var(--space-lg); }
    .gap-xl { gap: var(--space-xl); }
    .gap-2xl { gap: var(--space-2xl); }

    /* Card Components */
    .card {
      background: var(--bg-card);
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow-lg);
      padding: var(--space-2xl);
      transition: all 0.3s ease;
      border: 1px solid var(--border-glass);
    }

    .card-glass {
      background: var(--bg-glass);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-glass);
      border-radius: var(--border-radius-lg);
      padding: var(--space-2xl);
      transition: all 0.3s ease;
    }

    .card-glass:hover {
      background: var(--bg-glass-hover);
      transform: translateY(-2px);
    }

    /* Button Components */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-sm);
      padding: var(--space-lg) var(--space-3xl);
      border: none;
      border-radius: var(--border-radius-xl);
      font-family: var(--font-primary);
      font-weight: 600;
      font-size: var(--text-base);
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      text-decoration: none;
      letter-spacing: 0.5px;
    }

    .btn-primary {
      background: linear-gradient(45deg, var(--primary-blue), var(--primary-green));
      color: var(--text-primary);
      box-shadow: var(--shadow-accent);
    }

    .btn-primary:hover {
      transform: translateY(-2px) scale(1.02);
      box-shadow: 0 8px 25px rgba(46, 204, 113, 0.5);
    }

    .btn-secondary {
      background: linear-gradient(45deg, #3498db, #2980b9);
      color: var(--text-primary);
      box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
    }

    .btn-secondary:hover {
      transform: translateY(-2px) scale(1.02);
      box-shadow: 0 8px 25px rgba(52, 152, 219, 0.4);
    }

    /* Navigation */
    .navbar {
      position: fixed;
      top: 0;
      width: 100%;
      background: rgba(20, 30, 48, 0.95);
      backdrop-filter: blur(20px);
      z-index: 1000;
      padding: var(--space-lg) 0;
      border-bottom: 1px solid var(--border-accent);
      transition: all 0.3s ease;
    }

    .nav-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 var(--space-lg);
    }

    .brand {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      font-family: var(--font-heading);
      font-weight: 800;
      font-size: var(--text-2xl);
      color: var(--primary-green);
    }

    .brand-icon {
      width: 40px;
      height: 40px;
      background: linear-gradient(45deg, var(--primary-blue), var(--primary-green));
      border-radius: var(--border-radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: var(--text-xl);
    }

    .nav-menu {
      display: flex;
      list-style: none;
      gap: var(--space-3xl);
    }

    .nav-menu a {
      text-decoration: none;
      color: var(--text-secondary);
      font-weight: 500;
      transition: all 0.3s ease;
      padding: var(--space-xs) 0;
      border-bottom: 2px solid transparent;
    }

    .nav-menu a:hover {
      color: var(--primary-green);
      border-bottom-color: var(--primary-green);
    }

    /* Main Layout */
    .main-container {
      padding-top: 100px;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 120px var(--space-lg) var(--space-3xl);
    }

    .container {
      width: 100%;
      max-width: 1400px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--space-5xl);
      align-items: center;
    }

    /* Left Section */
    .left { 
      display: flex; 
      flex-direction: column; 
      gap: var(--space-3xl); 
      justify-content: center;
    }
    
    .hero-badge {
      background: rgba(46, 204, 113, 0.1);
      border: 1px solid rgba(46, 204, 113, 0.3);
      color: var(--primary-green);
      padding: var(--space-xs) var(--space-lg);
      border-radius: 50px;
      font-size: var(--text-sm);
      font-weight: 600;
      display: inline-block;
      align-self: center;
      margin-bottom: var(--space-sm);
    }
    
    .hero-title { 
      font-size: var(--text-4xl); 
      font-weight: 800; 
      line-height: 1.1; 
      font-family: var(--font-heading); 
      text-align: center;
      background: linear-gradient(135deg, #ffffff, var(--primary-green));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: var(--space-lg);
    }

    .hero-description {
      font-size: var(--text-xl);
      line-height: 1.6;
      color: var(--text-secondary);
      text-align: center;
      margin-bottom: var(--space-2xl);
    }

    /* Upload Box */
    .upload-box {
      border: 2px dashed var(--border-glass);
      border-radius: var(--border-radius-xl);
      padding: var(--space-5xl) var(--space-3xl);
      text-align: center;
      background: var(--bg-glass);
      backdrop-filter: blur(20px);
      transition: all 0.4s ease;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    .upload-box:hover {
      transform: translateY(-8px) scale(1.02);
      border-color: var(--primary-green);
      box-shadow: var(--shadow-accent);
      background: var(--bg-glass-hover);
    }

    .upload-content {
      position: relative;
      z-index: 1;
    }

    .upload-icon {
      width: 80px;
      height: 80px;
      background: linear-gradient(45deg, var(--primary-blue), var(--primary-green));
      border-radius: var(--border-radius-lg);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto var(--space-xl);
      font-size: 35px;
      transition: all 0.3s ease;
    }

    .upload-box:hover .upload-icon {
      transform: rotate(10deg) scale(1.1);
    }

    .upload-text {
      font-size: var(--text-xl);
      margin-bottom: var(--space-sm);
      font-weight: 600;
      color: var(--text-primary);
    }

    .upload-subtext {
      font-size: var(--text-sm);
      color: var(--text-tertiary);
    }

    #fileInput { display: none; }

    .buttons { 
      display: flex; 
      justify-content: center;
      gap: var(--space-lg);
      flex-wrap: wrap;
    }

    /* Right Section - Analysis Panel */
    .right {
      background: var(--bg-card);
      border-radius: var(--border-radius-xl); 
      box-shadow: var(--shadow-xl);
      display: flex; 
      flex-direction: column; 
      overflow: hidden;
      height: 700px;
      backdrop-filter: blur(20px);
      border: 1px solid var(--border-glass);
    }

    /* Tab System */
    .tabs { 
      display: flex; 
      position: relative; 
      background: var(--bg-card-secondary);
      border-bottom: 1px solid rgba(0,0,0,0.1);
    }

    .tab {
      flex: 1; 
      text-align: center; 
      padding: var(--space-lg) var(--space-sm);
      font-weight: 600; 
      cursor: pointer; 
      transition: all 0.3s ease;
      font-family: var(--font-heading); 
      color: var(--text-dark-secondary);
      font-size: var(--text-sm);
      position: relative;
    }

    .tab:hover {
      background: rgba(46, 204, 113, 0.05);
      color: var(--primary-blue);
    }

    .tab.active { 
      color: var(--primary-blue);
      background: rgba(46, 204, 113, 0.1);
    }

    .indicator { 
      position: absolute; 
      bottom: 0; 
      height: 4px; 
      width: 20%; 
      background: linear-gradient(45deg, var(--primary-blue), var(--primary-green));
      transition: left 0.4s ease; 
      left: 0;
      border-radius: 2px 2px 0 0;
    }

    .tab-content { 
      flex: 1; 
      padding: var(--space-2xl); 
      display: none; 
      animation: fadeInUp 0.6s ease; 
      overflow-y: auto; 
      color: var(--text-dark);
    }

    .tab-content.active { display: block; }

    @keyframes fadeInUp { 
      from { 
        opacity: 0; 
        transform: translateY(20px); 
      } 
      to { 
        opacity: 1; 
        transform: translateY(0); 
      } 
    }

    /* Content Sections */
    .section {
      margin: var(--space-xl) 0;
    }

    .section-header {
      font-family: var(--font-heading);
      font-weight: 600;
      font-size: var(--text-lg);
      color: var(--primary-blue);
      margin-bottom: var(--space-md);
    }

    .content-card {
      background: var(--bg-card-secondary);
      padding: var(--space-xl);
      border-radius: var(--border-radius-md);
      box-shadow: var(--shadow-sm);
      border: 1px solid rgba(0,0,0,0.05);
      margin: var(--space-lg) 0;
      transition: all 0.3s ease;
    }

    .content-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    /* Clause Cards */
    .clause-card {
      background: var(--bg-card-secondary);
      border-left: 4px solid var(--primary-green);
      padding: var(--space-xl);
      margin: var(--space-lg) 0;
      border-radius: var(--border-radius-md);
      box-shadow: var(--shadow-sm);
      transition: all 0.3s ease;
    }

    .clause-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }
    
    .clause-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--space-md);
      flex-wrap: wrap;
      gap: var(--space-sm);
    }
    
    .clause-title {
      font-weight: 600;
      color: var(--primary-blue);
      font-size: var(--text-base);
      flex: 1;
      min-width: 200px;
    }
    
    /* Badge System */
    .badge {
      padding: var(--space-xs) var(--space-md);
      border-radius: 25px;
      font-size: var(--text-xs);
      font-weight: 600;
      text-transform: uppercase;
      white-space: nowrap;
      flex-shrink: 0;
      box-shadow: var(--shadow-sm);
    }
    
    .badge-high { background: linear-gradient(45deg, var(--danger-red), #c0392b); color: white; }
    .badge-medium { background: linear-gradient(45deg, var(--warning-orange), #e67e22); color: white; }
    .badge-low { background: linear-gradient(45deg, var(--primary-green), #27ae60); color: white; }
    .badge-none { background: linear-gradient(45deg, #ecf0f1, #bdc3c7); color: var(--text-dark); }
    
    .clause-content {
      background: rgba(255, 255, 255, 0.8);
      padding: var(--space-lg);
      border-radius: var(--border-radius-sm);
      margin: var(--space-md) 0;
      font-style: italic;
      border-left: 3px solid #bdc3c7;
      color: var(--text-dark);
      line-height: 1.5;
      backdrop-filter: blur(5px);
    }
    
    .clause-explanation {
      color: var(--text-dark);
      line-height: 1.6;
      font-weight: 500;
    }

    /* Gap Cards */
    .gap-card {
      background: linear-gradient(135deg, #fff5f5, #ffffff);
      border-left: 4px solid var(--danger-red);
      padding: var(--space-xl);
      margin: var(--space-lg) 0;
      border-radius: var(--border-radius-md);
      box-shadow: 0 4px 15px rgba(231, 76, 60, 0.1);
      transition: all 0.3s ease;
    }

    .gap-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(231, 76, 60, 0.15);
    }
    
    .gap-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--space-sm);
      flex-wrap: wrap;
      gap: var(--space-sm);
    }
    
    .gap-issue {
      font-weight: 600;
      color: var(--danger-red);
      flex: 1;
      min-width: 200px;
    }
    
    .gap-explanation, .gap-recommendation {
      margin: var(--space-sm) 0;
      color: var(--text-dark-secondary);
      line-height: 1.5;
    }
    
    .gap-recommendation {
      background: rgba(248, 249, 250, 0.8);
      padding: var(--space-md);
      border-radius: var(--border-radius-sm);
      border-left: 3px solid var(--primary-green);
      backdrop-filter: blur(5px);
    }

    /* Verdict Section */
    .verdict-section {
      text-align: center;
      padding: var(--space-xl);
      margin: var(--space-xl) 0;
      border-radius: var(--border-radius-md);
      font-weight: 600;
      font-size: var(--text-lg);
      backdrop-filter: blur(10px);
    }
    
    .verdict-safe {
      background: linear-gradient(135deg, #d4edda, #c3e6cb);
      color: #155724;
      border: 1px solid #c3e6cb;
      box-shadow: 0 4px 15px rgba(21, 87, 36, 0.1);
    }
    
    .verdict-warning {
      background: linear-gradient(135deg, #f8d7da, #f5c6cb);
      color: #721c24;
      border: 1px solid #f5c6cb;
      box-shadow: 0 4px 15px rgba(114, 28, 36, 0.1);
    }

    /* Info Grid */
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: var(--space-lg);
      margin: var(--space-xl) 0;
    }
    
    .info-card {
      background: var(--bg-card-secondary);
      padding: var(--space-lg);
      border-radius: var(--border-radius-md);
      border-left: 4px solid #3498db;
      box-shadow: var(--shadow-sm);
      transition: all 0.3s ease;
    }

    .info-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }
    
    .info-title {
      font-weight: 600;
      color: var(--primary-blue);
      margin-bottom: var(--space-xs);
      font-family: var(--font-heading);
      font-size: var(--text-sm);
    }

    .info-value {
      color: var(--text-dark);
      font-size: var(--text-base);
    }

    /* Empty States */
    .empty-state {
      text-align: center;
      padding: var(--space-5xl) var(--space-lg);
      color: var(--text-dark-secondary);
    }

    .empty-icon {
      font-size: var(--text-4xl);
      margin-bottom: var(--space-lg);
      opacity: 0.3;
    }

    .empty-title {
      font-size: var(--text-lg);
      margin-bottom: var(--space-sm);
      font-weight: 600;
    }

    .empty-description {
      font-size: var(--text-sm);
      opacity: 0.7;
    }

    /* Loading States */
    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Disclaimer */
    .disclaimer {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(10px);
      color: #ffcc00;
      padding: var(--space-sm) 0;
      text-align: center;
      font-size: var(--text-sm);
      z-index: 999;
      border-top: 1px solid rgba(255, 204, 0, 0.2);
    }

    .disclaimer-text {
      animation: scroll-left 35s linear infinite;
      white-space: nowrap;
      font-weight: 600;
    }

    @keyframes scroll-left {
      0% { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }

    /* Responsive Design */
    @media(max-width: 1200px) {
      .container { 
        grid-template-columns: 1fr; 
        gap: var(--space-3xl);
      }
      .left { 
        text-align: center; 
        align-items: center; 
      }
      .right {
        height: 600px;
      }
    }

    @media(max-width: 768px) {
      .nav-menu { display: none; }
      .main-container { padding: 100px var(--space-md) var(--space-3xl); }
      .hero-title { font-size: var(--text-3xl); }
      .hero-description { font-size: var(--text-lg); }
      .upload-box { padding: var(--space-3xl) var(--space-lg); }
      .info-grid { grid-template-columns: 1fr; }
      .clause-header, .gap-header {
        flex-direction: column;
        align-items: flex-start;
        gap: var(--space-xs);
      }
      .buttons { 
        flex-direction: column; 
        align-items: center; 
      }
      .btn { 
        width: 100%; 
        max-width: 300px; 
        justify-content: center; 
      }
    }

    /* Animation Utilities */
    @keyframes pulse {
      0% { box-shadow: var(--shadow-accent); }
      50% { box-shadow: 0 8px 25px rgba(46, 204, 113, 0.6); }
      100% { box-shadow: var(--shadow-accent); }
    }

    @keyframes ripple {
      to {
        transform: scale(2);
        opacity: 0;
      }
    }

    .animate-pulse {
      animation: pulse 2s infinite;
    }

    /* --- ADDED: Styles for Q&A section --- */
    .qna-input-container { display: flex; gap: var(--space-sm); margin-bottom: var(--space-lg); }
    #qnaInput { flex: 1; padding: var(--space-md); border-radius: var(--border-radius-sm); border: 1px solid rgba(0,0,0,0.1); font-size: var(--text-sm); font-family: var(--font-primary); }
    #askBtn { padding: 0 var(--space-xl); border: none; background: var(--primary-blue); color: white; font-weight: 600; border-radius: var(--border-radius-sm); cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: var(--space-sm); }
    #askBtn:hover { background: #1e3a75; }
    .qna-answer { background: var(--bg-card-secondary); padding: var(--space-lg); border-radius: var(--border-radius-md); min-height: 100px; color: var(--text-dark); line-height: 1.6; border-left: 4px solid var(--primary-green); margin-bottom: var(--space-2xl); white-space: pre-wrap; }
    .suggested-questions .chip { display: inline-block; background: rgba(46, 204, 113, 0.1); color: var(--primary-blue); padding: var(--space-sm) var(--space-lg); border-radius: 25px; font-size: var(--text-xs); font-weight: 600; cursor: pointer; transition: all 0.3s ease; border: 1px solid transparent; margin: var(--space-xs); }
    .suggested-questions .chip:hover { background: rgba(46, 204, 113, 0.2); border-color: var(--primary-green); transform: translateY(-2px); }

    /* --- ADDED: Styles for Inline Risk Warning Card --- */
    .risk-summary-card {
        display: flex;
        align-items: center;
        gap: var(--space-xl);
        background: linear-gradient(135deg, #fff5f5, #ffffff);
        border: 2px solid var(--danger-red);
        padding: var(--space-2xl);
        margin-top: var(--space-2xl);
        border-radius: var(--border-radius-lg);
        box-shadow: 0 4px 15px rgba(231, 76, 60, 0.15);
    }
    .risk-icon {
        font-size: var(--text-4xl);
    }
    .risk-content {
        flex: 1;
    }
    .risk-title {
        color: var(--danger-red);
        margin-bottom: var(--space-sm);
    }
    .risk-text {
        color: var(--text-dark-secondary);
        line-height: 1.6;
        margin-bottom: var(--space-lg);
    }

  </style>
</head>
<body>
  <nav class="navbar">
    <div class="nav-content">
      <a href="index.html" class="brand" style="text-decoration:none; color:inherit;">
        <div class="brand-icon">🔮</div>
        LegalDemyst
      </a>

      <ul class="nav-menu">
        <li><a href="index.html#features">Features</a></li>
        <li><a href="index.html#how-it-works">How It Works</a></li>
        <li><a href="#pricing">Pricing</a></li>
        <li><a href="#contact">Contact</a></li>
      </ul>
      <a href="index.html" class="btn btn-primary text-sm">← Back to Home</a>
    </div>
  </nav>

  <div class="main-container" id="analysisContainer">
    <div class="container">
      <div class="left">
        
        <h1 class="hero-title heading">Upload & Analyze Your <span style="color: var(--primary-green);">Legal Document</span></h1>
        
        <p class="hero-description">
          Get instant AI-powered analysis of your contracts, agreements, and legal documents in seconds.
        </p>
        
        <div class="upload-box" onclick="document.getElementById('fileInput').click();">
          <div class="upload-content">
            <div class="upload-icon">📄</div>
            <p class="upload-text">Drop your document here, or <span style="color: var(--primary-green); text-decoration: underline; cursor: pointer;">browse</span></p>
            <small class="upload-subtext">Supports PDF, DOC, DOCX, TXT files up to 10MB</small>
          </div>
        </div>
        <input type="file" id="fileInput" accept=".doc,.docx,.pdf,.txt">

        <div class="buttons">
          <button class="btn btn-secondary" onclick="analyzeDocument()">
            <span>🔍</span>
            Analyze Document
            <span class="loading-spinner" id="analyzeSpinner" style="display: none;"></span>
          </button>
        </div>
        
        <p class="text-sm text-center" style="color: var(--text-tertiary); font-style: italic; margin-top: var(--space-sm);">
          ⏱️ Analysis typically takes 15-30 seconds
        </p>
      </div>

      <div class="right">
        <div class="tabs">
          <div class="tab active" onclick="showTab(0)">📋 Document</div>
          <div class="tab" onclick="showTab(1)">📊 Summary</div>
          <div class="tab" onclick="showTab(2)">🔍 Clauses</div>
          <div class="tab" onclick="showTab(3)">⚠️ Gaps</div>
          <div class="tab" onclick="showTab(4)">❓ Q&A</div>
          <div class="indicator"></div>
        </div>

        <div class="tab-content active" id="tab0">
          <div class="text-display" id="textDisplay">
            <div class="empty-state">
              <div class="empty-icon">📄</div>
              <p class="empty-title">Upload a document to get started</p>
              <p class="empty-description">Your document content will appear here</p>
            </div>
          </div>
        </div>
        
        <div class="tab-content" id="tab1">
          <div class="summary-section" id="summarySection">
            <div class="empty-state">
              <div class="empty-icon">🎯</div>
              <p class="empty-title">Ready for analysis</p>
              <p class="empty-description">Click "Analyze Document" to generate comprehensive insights</p>
            </div>
          </div>
        </div>
        
        <div class="tab-content" id="tab2">
          <div class="empty-state">
            <div class="empty-icon">🔍</div>
            <p class="empty-title">Clause Analysis</p>
            <p class="empty-description">Detailed breakdown of legal terms and conditions will appear here</p>
          </div>
        </div>
        
        <div class="tab-content" id="tab3">
          <div class="empty-state">
            <div class="empty-icon">⚠️</div>
            <p class="empty-title">Gap Analysis</p>
            <p class="empty-description">Potential issues and missing clauses will be identified here</p>
          </div>
        </div>
        
        <div class="tab-content" id="tab4">
            <div class="qna-section">
                <div class="section-header">Ask a Question About Your Document</div>
                <div class="qna-input-container">
                    <input type="text" id="qnaInput" placeholder="e.g., 'What is the governing law?'">
                    <button id="askBtn">Ask <span class="loading-spinner" id="qnaSpinner" style="display: none;"></span></button>
                </div>
                <div class="qna-answer" id="qnaAnswer">
                  <div class="empty-state" style="padding: var(--space-lg) 0;">
                    <p class="empty-description">Your answer will appear here. Please analyze a document first.</p>
                  </div>
                </div>
        
                <div class="suggested-questions" id="suggestedQuestions">
                    <div class="section-header">Suggested Questions</div>
                    <div class="empty-state" style="padding: var(--space-lg) 0;">
                        <div class="empty-icon">💡</div>
                        <p class="empty-description">Analyze a document to generate question suggestions.</p>
                    </div>
                </div>
            </div>
        </div>

      </div>
    </div>
  </div>

  <div class="main-container" id="nextStepsContainer" style="display: none;">
      <div class="container" style="grid-template-columns: 1fr;">
          <div class="left" style="align-items: center;">
              <h1 class="hero-title heading">Choose Your Next Step</h1>
              <p class="hero-description">
                  Based on the analysis, you can choose to generate a revised document or consult with a legal professional.
              </p>
              <div class="buttons" style="flex-direction: column; align-items: center; gap: var(--space-xl);">
                  <button class="btn btn-primary" style="width: 100%; max-width: 400px;" onclick="window.location.href='gemm.html'">
                      <span>📝</span> Generate Revised Document
                  </button>
                  <button class="btn btn-secondary" style="width: 100%; max-width: 400px;" onclick="window.location.href='gemm.html'">
                      <span>🧑‍⚖️</span> Seek a Lawyer
                  </button>
              </div>
          </div>
      </div>
  </div>
  
  <div class="disclaimer">
    <div class="disclaimer-text">
      ⚠️ Notice: LegalDemyst provides AI-powered legal document analysis for informational purposes only. This is not legal advice. Consult qualified legal professionals for official guidance. ⚠️
    </div>
  </div>

  <script>
    const backendURL = "http://127.0.0.1:8001";
    let uploadedFile = null;
    let analysisData = null;

    // Navbar scroll effect
    window.addEventListener('scroll', () => {
      const navbar = document.querySelector('.navbar');
      if (window.scrollY > 50) {
        navbar.style.background = 'rgba(20, 30, 48, 0.98)';
        navbar.style.boxShadow = '0 4px 20px rgba(0, 0, 0, 0.3)';
      } else {
        navbar.style.background = 'rgba(20, 30, 48, 0.95)';
        navbar.style.boxShadow = 'none';
      }
    });

    // File input handler
    document.getElementById('fileInput').addEventListener('change', (event) => {
      uploadedFile = event.target.files[0];
      if (uploadedFile) {
        // Validate file type
        const allowedTypes = ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'text/plain'];
        if (!allowedTypes.includes(uploadedFile.type)) {
          alert('Please upload a PDF, DOC, DOCX, or TXT file.');
          return;
        }

        // Validate file size (10MB limit)
        if (uploadedFile.size > 10 * 1024 * 1024) {
          alert('File size must be less than 10MB.');
          return;
        }

        document.getElementById('textDisplay').innerHTML = `
          <div class="empty-state" style="color: var(--primary-green);">
            <div class="empty-icon">✅</div>
            <p class="empty-title">Document Ready</p>
            <p class="empty-description">${uploadedFile.name}</p>
            <p class="text-xs" style="margin-top: var(--space-md); opacity: 0.6;">Click "Analyze Document" to proceed</p>
          </div>
        `;
        
        // Add pulse effect to analyze button
        const analyzeBtn = document.querySelector('.btn-secondary');
        analyzeBtn.classList.add('animate-pulse');
      }
    });

    function showTab(index) {
      const tabs = document.querySelectorAll('.tab');
      const contents = document.querySelectorAll('.tab-content');
      
      tabs.forEach(t => t.classList.remove('active'));
      contents.forEach(c => c.classList.remove('active'));
      
      tabs[index].classList.add('active');
      contents[index].classList.add('active');
      
      document.querySelector('.indicator').style.left = `${index * 20}%`;
    }

    function createClauseCard(term) {
      const riskClass = `badge-${term.risk_level.toLowerCase()}`;
      
      return `
        <div class="clause-card">
          <div class="clause-header">
            <span class="clause-title">${term.term}</span>
            <span class="badge ${riskClass}">${term.risk_level} Risk</span>
          </div>
          ${term.content ? `<div class="clause-content">"${term.content}"</div>` : ''}
          <div class="clause-explanation">${term.explanation}</div>
        </div>
      `;
    }

    function createGapCard(gap) {
      const severityClass = `badge-${gap.severity.toLowerCase()}`;
      
      return `
        <div class="gap-card">
          <div class="gap-header">
            <span class="gap-issue">${gap.issue}</span>
            <span class="badge ${severityClass}">${gap.severity}</span>
          </div>
          <div class="gap-explanation">${gap.explanation}</div>
          <div class="gap-recommendation">
            <strong>💡 Recommendation:</strong> ${gap.recommendation}
          </div>
        </div>
      `;
    }

    function createRiskGuide() {
      return `
        <div class="content-card" style="background: linear-gradient(135deg, #e3f2fd, #ffffff); border-left: 4px solid #2196f3;">
          <h4 class="section-header" style="color: #1976d2; margin-bottom: var(--space-lg);">📊 Risk Level Guide</h4>
          <div class="gap-md" style="display: flex; flex-direction: column;">
            <div style="display: flex; align-items: center; gap: var(--space-md); margin: var(--space-sm) 0; padding: var(--space-xs); border-radius: var(--border-radius-sm); transition: all 0.2s ease;">
              <span class="badge badge-high" style="min-width: 80px; text-align: center;">HIGH RISK</span>
              <span style="flex: 1; color: var(--text-dark);">Could cause significant problems, review carefully</span>
            </div>
            <div style="display: flex; align-items: center; gap: var(--space-md); margin: var(--space-sm) 0; padding: var(--space-xs); border-radius: var(--border-radius-sm); transition: all 0.2s ease;">
              <span class="badge badge-medium" style="min-width: 80px; text-align: center;">MEDIUM RISK</span>
              <span style="flex: 1; color: var(--text-dark);">Worth understanding, may need clarification</span>
            </div>
            <div style="display: flex; align-items: center; gap: var(--space-md); margin: var(--space-sm) 0; padding: var(--space-xs); border-radius: var(--border-radius-sm); transition: all 0.2s ease;">
              <span class="badge badge-low" style="min-width: 80px; text-align: center;">LOW RISK</span>
              <span style="flex: 1; color: var(--text-dark);">Standard clause, generally safe</span>
            </div>
            <div style="display: flex; align-items: center; gap: var(--space-md); margin: var(--space-sm) 0; padding: var(--space-xs); border-radius: var(--border-radius-sm); transition: all 0.2s ease;">
              <span class="badge badge-none" style="min-width: 80px; text-align: center;">NO RISK</span>
              <span style="flex: 1; color: var(--text-dark);">Routine administrative clause</span>
            </div>
          </div>
        </div>
      `;
    }

    async function analyzeDocument() {
      if (!uploadedFile) { 
        alert("Please upload a document first!"); 
        return; 
      }
      
      const loadingHTML = `
        <div class="empty-state" style="color: var(--primary-green);">
          <div class="loading-spinner" style="margin: 0 auto var(--space-lg);"></div>
          <p class="empty-title">Analyzing your document...</p>
          <p class="empty-description">This may take a few moments</p>
        </div>
      `;
      
      document.getElementById('summarySection').innerHTML = loadingHTML;
      document.getElementById('tab2').innerHTML = loadingHTML;
      document.getElementById('tab3').innerHTML = loadingHTML;

      const formData = new FormData();
      formData.append('file', uploadedFile);

      try {
        const response = await fetch(`${backendURL}/analyze`, { method: 'POST', body: formData });
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        analysisData = data;

        // Populate Summary Tab
        let summaryHTML = `
          <div class="verdict-section ${data.verdict === 'Red Flag' ? 'verdict-warning' : 'verdict-safe'}">
            ${data.verdict === 'Red Flag' ? '⚠️' : '✅'} ${data.verdict}
          </div>
          
          <div class="info-grid">
            <div class="info-card">
              <div class="info-title">Document Type</div>
              <div class="info-value">${data.document_type || 'Unknown'}</div>
            </div>
            <div class="info-card">
              <div class="info-title">Terms Count</div>
              <div class="info-value">${data.extracted_terms ? data.extracted_terms.length : 0} clauses found</div>
            </div>
          </div>
          
          <div class="section">
            <h3 class="section-header">📄 Document Summary</h3>
            <div class="content-card">
              <p style="line-height: 1.6; color: var(--text-dark);">${data.summary || 'No summary available'}</p>
            </div>
          </div>
        `;
        if (data.key_obligations && data.key_obligations.length > 0) {
          summaryHTML += `
            <div class="section">
              <h4 class="section-header">📋 Your Key Obligations</h4>
              <div class="content-card" style="background: linear-gradient(135deg, #fff3cd, #ffffff); border-left: 4px solid var(--warning-orange);">
                <ul style="margin-left: var(--space-lg);">
                  ${data.key_obligations.map(obligation => `<li style="margin: var(--space-sm) 0; color: var(--text-dark); line-height: 1.5;">${obligation}</li>`).join('')}
                </ul>
              </div>
            </div>
          `;
        }
        document.getElementById('summarySection').innerHTML = summaryHTML;

        // Populate Clauses Tab
        let clausesHTML = `${createRiskGuide()}`;
        if (data.extracted_terms && data.extracted_terms.length > 0) {
          data.extracted_terms.forEach(term => {
            clausesHTML += createClauseCard(term);
          });
        } else {
          clausesHTML += '<div class="empty-state"><p class="empty-description">No specific clauses identified.</p></div>';
        }
        document.getElementById('tab2').innerHTML = clausesHTML;

        // Populate Gaps Tab
        let gapsHTML = `<div class="section"><h3 class="section-header" style="color: var(--danger-red);">⚠️ Potential Issues & Missing Clauses</h3></div>`;
        if (data.gaps && data.gaps.length > 0) {
          data.gaps.forEach(gap => {
            gapsHTML += createGapCard(gap);
          });

          // --- MODIFIED: Append the inline warning card at the end of the gaps list ---
          gapsHTML += `
            <div class="risk-summary-card">
              <div class="risk-icon">⚠️</div>
              <div class="risk-content">
                <h3 class="risk-title heading">Significant Risks Identified</h3>
                <p class="risk-text">Based on the gaps found, we recommend taking further action to protect your interests.</p>
                <button class="btn btn-primary" onclick="proceedToNextSteps()">Proceed to Resolution Options</button>
              </div>
            </div>
          `;
        } else {
          gapsHTML += `<div class="empty-state"><div class="empty-icon" style="color: var(--primary-green);">✅</div><h4 class="empty-title" style="color: var(--primary-green);">No Major Gaps Identified</h4><p class="empty-description">This document appears to cover the essential legal bases.</p></div>`;
        }
        document.getElementById('tab3').innerHTML = gapsHTML;
        
        if (analysisData.document_id) {
            fetchSuggestedQuestions(analysisData.document_id);
        }

        showTab(1);
        const analyzeBtn = document.querySelector('.btn-secondary');
        analyzeBtn.classList.remove('animate-pulse');
      } catch (err) {
        console.error('Analysis error:', err);
        const errorHTML = `
          <div class="empty-state" style="color: var(--danger-red);">
            <div class="empty-icon">❌</div>
            <p class="empty-title">Analysis Failed</p>
            <p class="empty-description">Error: ${err.message || 'Connection failed - make sure the backend is running'}</p>
          </div>
        `;
        document.getElementById('summarySection').innerHTML = errorHTML;
        document.getElementById('tab2').innerHTML = errorHTML;
        document.getElementById('tab3').innerHTML = errorHTML;
      }
    }

    // --- ADDED: LOGIC FOR NEXT STEPS ---

    function proceedToNextSteps() {
        document.getElementById('analysisContainer').style.display = 'none';
        document.getElementById('nextStepsContainer').style.display = 'flex';
    }

    // --- JAVASCRIPT LOGIC FOR Q&A ---

    async function fetchSuggestedQuestions(documentId) {
        try {
            const response = await fetch(`${backendURL}/suggest-questions`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ document_id: documentId })
            });
            if (!response.ok) throw new Error('Could not fetch suggestions.');
            const data = await response.json();
            populateSuggestedQuestions(data.questions);
        } catch (error) {
            console.error("Error fetching suggestions:", error);
            document.getElementById('suggestedQuestions').innerHTML = '<p>Could not load suggestions.</p>';
        }
    }

    function populateSuggestedQuestions(questions) {
        const container = document.getElementById('suggestedQuestions');
        if (!questions || questions.length === 0) {
            container.innerHTML = '<p>No suggestions available.</p>';
            return;
        }
        let html = '<div class="section-header">Suggested Questions</div>';
        questions.forEach(q => {
            const sanitizedQ = q.replace(/'/g, "\\'").replace(/"/g, '&quot;');
            html += `<span class="chip" onclick="askSuggested('${sanitizedQ}')">${q}</span>`;
        });
        container.innerHTML = html;
    }

    function askSuggested(question) {
        document.getElementById('qnaInput').value = question;
        handleAskQuestion();
    }

    async function handleAskQuestion() {
        const qnaInput = document.getElementById('qnaInput');
        const question = qnaInput.value.trim();
        if (!question) { alert("Please enter a question."); return; }
        if (!analysisData || !analysisData.document_id) { alert("Please analyze a document first."); return; }

        const qnaSpinner = document.getElementById('qnaSpinner');
        const askBtn = document.getElementById('askBtn');
        const answerDiv = document.getElementById('qnaAnswer');

        qnaSpinner.style.display = 'inline-block';
        askBtn.disabled = true;
        answerDiv.innerHTML = `<div class="empty-state" style="padding: var(--space-lg) 0;"><div class="loading-spinner" style="border-top-color: var(--primary-green);"></div><p class="empty-description">Finding an answer...</p></div>`;

        try {
            const response = await fetch(`${backendURL}/qna`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ document_id: analysisData.document_id, question: question })
            });
            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(errorData.detail || 'Failed to get an answer.');
            }
            const result = await response.json();
            answerDiv.innerText = result.answer;
            qnaInput.value = ''; 
        } catch (error) {
            answerDiv.innerText = `Sorry, an error occurred: ${error.message}`;
            console.error("Q&A Error:", error);
        } finally {
            qnaSpinner.style.display = 'none';
            askBtn.disabled = false;
        }
    }

    document.getElementById('askBtn').addEventListener('click', handleAskQuestion);
    document.getElementById('qnaInput').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            e.preventDefault();
            handleAskQuestion();
        }
    });
  </script>
</body>
</html>